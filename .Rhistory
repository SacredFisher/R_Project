#2010 to 2015
#pmatrix
p.mat10<- full %>%  filter(date >= '2011-01-01' & date <= '2015-12-31') %>% select(`peak-rank`, `weeks-on-board`, acousticness,danceability,energy,instrumentalness,liveness,loudness, tempo, speechiness, happiness) %>%
as.matrix() %>% cor(use="complete.obs") %>% cor_pmat()
#corr matrix and plot
plt_4<-full %>%  filter(date >= '2011-01-01' & date <= '2015-12-31') %>% select(`peak-rank`, `weeks-on-board`, acousticness,danceability,energy,instrumentalness,liveness,loudness, tempo, speechiness, happiness) %>%
as.matrix() %>% cor(use="complete.obs") %>%
ggcorrplot( hc.order = TRUE, type = "lower", lab = TRUE, insig = "blank", p.mat = p.mat10) +labs(title="2011-2015 Correlations")
#2015 to 2021
#pmatrix
p.mat15<- full %>% filter(date >= '2016-01-01') %>% select(`peak-rank`, `weeks-on-board`, acousticness,danceability,energy,instrumentalness,liveness,loudness, tempo, speechiness, happiness) %>%
as.matrix() %>% cor(use="complete.obs") %>% cor_pmat()
#corr matrix and plot
plt_5<-full %>% filter(date >= '2016-01-01') %>% select(`peak-rank`, `weeks-on-board`, acousticness,danceability,energy,instrumentalness,liveness,loudness, tempo, speechiness, happiness) %>%
as.matrix() %>% cor(use="complete.obs") %>%
ggcorrplot( hc.order = TRUE, type = "lower", lab = TRUE, insig = "blank", p.mat = p.mat15) +labs(title="2016-2021 Correlations")
install.packages('patchwork')
plt_1 +plt_2
plt_1
plt_1 + plt_2
rlang::last_error()
library(patchwork)
plt_1 + plt_2
(plt_1 + plt_2+ plt_3)/ (plt_4 |plt_5)
(plt_1 + plt_2+ plt_3)
(plt_1 + plt_2+ plt_3) +labs(title = "Significant Correlations from 1997-2010")
p +labs(title = "Significant Correlations from 1997-2010")
p<-(plt_1 + plt_2+ plt_3)
p +labs(title = "Significant Correlations from 1997-2010")
(plt_4 |plt_5)
#2010 to 2015
#pmatrix
p.mat10<- full %>%  filter(date >= '2011-01-01' & date <= '2015-12-31') %>% select(`peak-rank`, `weeks-on-board`, acousticness,danceability,energy,instrumentalness,liveness,loudness, tempo, speechiness, happiness) %>%
as.matrix() %>% cor(use="complete.obs") %>% cor_pmat()
#corr matrix and plot
plt_4<-full %>%  filter(date >= '2011-01-01' & date <= '2015-12-31') %>% select(`peak-rank`, `weeks-on-board`, acousticness,danceability,energy,instrumentalness,liveness,loudness, tempo, speechiness, happiness) %>%
as.matrix() %>% cor(use="complete.obs") %>%
ggcorrplot( type = "lower", lab = TRUE, insig = "blank", p.mat = p.mat10) +labs(title="2011-2015 Correlations")
#2015 to 2021
#pmatrix
p.mat15<- full %>% filter(date >= '2016-01-01') %>% select(`peak-rank`, `weeks-on-board`, acousticness,danceability,energy,instrumentalness,liveness,loudness, tempo, speechiness, happiness) %>%
as.matrix() %>% cor(use="complete.obs") %>% cor_pmat()
#corr matrix and plot
plt_5<-full %>% filter(date >= '2016-01-01') %>% select(`peak-rank`, `weeks-on-board`, acousticness,danceability,energy,instrumentalness,liveness,loudness, tempo, speechiness, happiness) %>%
as.matrix() %>% cor(use="complete.obs") %>%
ggcorrplot( type = "lower", lab = TRUE, insig = "blank", p.mat = p.mat15) +labs(title="2016-2021 Correlations")
(plt_1 + plt_2+ plt_3)
(plt_4 |plt_5)
#Plot One
(plt_1 + plt_2+ plt_3)
#Plot Two
(plt_4 |plt_5)
full %>%  filter(date >= '2011-01-01' & date <= '2015-12-31') %>% select(`peak-rank`, `weeks-on-board`, acousticness,danceability,energy,instrumentalness,liveness,loudness, tempo, speechiness, happiness) %>%
as.matrix() %>% cor(use="complete.obs")
full %>%  filter(date >= '2011-01-01' & date <= '2015-12-31') %>% select(`peak-rank`, `weeks-on-board`, acousticness,danceability,energy,instrumentalness,liveness,loudness, tempo, speechiness, happiness) %>%
summary()
full %>%  filter(date >= '2011-01-01' & date <= '2015-12-31') %>% select(`peak-rank`, `weeks-on-board`, acousticness,danceability,energy,instrumentalness,liveness,loudness, tempo, speechiness, happiness) %>%
sd()
full %>%  filter(date >= '2011-01-01' & date <= '2015-12-31') %>% select(`weeks-on-board`, acousticness) %>%
summary()
small$acousticness %>% sd()
small <-full %>%  filter(date >= '2011-01-01' & date <= '2015-12-31') %>% select(`weeks-on-board`, acousticness)
small %>%
summary()
small$acousticness %>% sd()
small <-full %>%  filter(date >= '2011-01-01' & date <= '2015-12-31') %>% select(`weeks-on-board`, acousticness)
small
small <-full %>%  filter(date >= '2011-01-01' & date <= '2015-12-31', `weeks-on-board` >29)
small %>%
summary()
long <-full %>%  filter(date >= '2011-01-01' & date <= '2015-12-31', `weeks-on-board` >29)
long$long_weeks <- TRUE
short<-full %>% filter(date >= '2011-01-01' & date <= '2015-12-31', `weeks-on-board` <=29)
fil <-full %>%  filter(date >= '2011-01-01' & date <= '2015-12-31', `weeks-on-board` >29)
fil$long_weeks <- fil$`weeks-on-board` >29
fil
full %>%  filter(date >= '2011-01-01' & date <= '2015-12-31', `weeks-on-board` >29)
full %>%  filter(date >= '2011-01-01' & date <= '2015-12-31', `weeks-on-board` >29)
full$long_weeks <- full$`weeks-on-board` >29
full$long_weeks <- full$`weeks-on-board` <=29
full
full$long_weeks <- full$`weeks-on-board` >29
full
full %>%  filter(date >= '2011-01-01' & date <= '2015-12-31', `weeks-on-board` >29)
full$long_weeks <- full$`weeks-on-board` >29
full
temp<-full %>%filter(date >= '2011-01-01' & date <= '2015-12-31', `weeks-on-board` >29)
temp$acousticness %>% sd()
full %>%  filter(date >= '2011-01-01' & date <= '2015-12-31', `weeks-on-board` >29) %>%
ggplot() + geom_boxplot(aes(, disp, group = long_weeks))
full %>%  filter(date >= '2011-01-01' & date <= '2015-12-31', `weeks-on-board` >29) %>%
ggplot() + geom_boxplot(aes(long_weeks, acousticness, group = long_weeks))
full %>%  filter(date >= '2011-01-01' & date <= '2015-12-31') %>% select(`weeks-on-board`) %>% summary()
filt<- full %>%  filter(date >= '2011-01-01' & date <= '2015-12-31')
filt$type <- as.factor('a.short')
filt$type <- as.factor('b.mid')
filt<- full %>%  filter(date >= '2011-01-01' & date <= '2015-12-31')
if(filt$`weeks-on-board` >=1 & filt$`weeks-on-board` <14){
filt$type <- as.factor('a.short')
}
if(filt$`weeks-on-board` >= 14 & filt$`weeks-on-board` <18){
filt$type <- as.factor('b.lomid')
}
install.packages("gtools")
##Investigating the Acoustic Songs in 2010-2015
full %>%  filter(date >= '2011-01-01' & date <= '2015-12-31') %>% select(`weeks-on-board`) %>% summary()
##Investigating the Acoustic Songs in 2010-2015
full %>%  filter(date >= '2011-01-01' & date <= '2015-12-31') %>% select(`weeks-on-board`) %>% quantcut(q = 4, na.rm = TRUE)
library(gtools)
##Investigating the Acoustic Songs in 2010-2015
full %>%  filter(date >= '2011-01-01' & date <= '2015-12-31') %>% select(`weeks-on-board`) %>% quantcut(q = 4, na.rm = TRUE)
##Investigating the Acoustic Songs in 2010-2015
full %>%  filter(date >= '2011-01-01' & date <= '2015-12-31') %>% select(`weeks-on-board`) %>% quantcut(q = 4, na.rm = TRUE)
##Investigating the Acoustic Songs in 2010-2015
full %>%  filter(date >= '2011-01-01' & date <= '2015-12-31') %>% select(`weeks-on-board`) %>%
quantcut(full$`weeks-on-board`, q = 4, na.rm = TRUE)
full$`weeks-on-board`
##Investigating the Acoustic Songs in 2010-2015
full %>%  filter(date >= '2011-01-01' & date <= '2015-12-31') %>% select(`weeks-on-board`) %>%
quantcut(full$`weeks-on-board`)
##Investigating the Acoustic Songs in 2010-2015
full %>%  filter(date >= '2011-01-01' & date <= '2015-12-31') %>% select(`weeks-on-board`) %>%
x<-full$`weeks-on-board`
normalized = (x-min(x))/(max(x)-min(x))
##Investigating the Acoustic Songs in 2010-2015
full %>%  filter(date >= '2011-01-01' & date <= '2015-12-31') %>% select(`weeks-on-board`) %>%
x<-full$`weeks-on-board`
##Investigating the Acoustic Songs in 2010-2015
full %>%  filter(date >= '2011-01-01' & date <= '2015-12-31') %>% select(`weeks-on-board`)
x<-full$`weeks-on-board`
normalized = (x-min(x))/(max(x)-min(x))
normalized
quantcut(normalized)
filt<- full %>%  filter(date >= '2011-01-01' & date <= '2015-12-31')
x<-filt$`weeks-on-board`
normalized = (x-min(x))/(max(x)-min(x))
quantcut(normalized)
filt$weeks_quartile<-quantcut(normalized)
filt
filt %>%
ggplot() + geom_boxplot(aes(long_weeks, acousticness, group = long_weeks))
filt %>%
ggplot() + geom_boxplot(aes(weeks_quartile, acousticness, group = weeks_quartile))
filt$normalized = (x-min(x))/(max(x)-min(x))
filt$weeks_quartile<-quantcut(normalized)
filt %>%
ggplot() + geom_boxplot(aes(weeks_quartile, acousticness, group = weeks_quartile))+geom_density(aes(x=filt$`weeks-on-board`), fill = filt$normalized)
#1997 to 2000
#Find Average stats
nines <- full %>%  filter(date < '2000-01-01') %>%
select(`peak-rank`, `weeks-on-board`,acousticness,danceability,energy, instrumentalness, happiness )
filt %>%
ggplot() + geom_boxplot(aes(weeks_quartile, acousticness, group = weeks_quartile))
#Plot One
(plt_1 + plt_2+ plt_3)
#Plot Two
(plt_4 |plt_5)
filt<- full %>%  filter(date >= '2011-01-01' & date <= '2015-12-31')
x<-filt$`weeks-on-board`
filt$normalized = (x-min(x))/(max(x)-min(x))
filt$weeks_quartile<-quantcut(normalized)
temp<-full %>%filter(date >= '2011-01-01' & date <= '2015-12-31', `weeks-on-board` >29)
temp$acousticness %>% sd()
filt %>%
ggplot() + geom_boxplot(aes(weeks_quartile, acousticness, group = weeks_quartile))
filt %>%
ggplot() + geom_boxplot(aes(weeks_quartile, acousticness, group = weeks_quartile)) + labs(title="The Longest Lasting songs these years were Acoustic")
filt %>%
ggplot() + geom_boxplot(aes(weeks_quartile, acousticness, group = weeks_quartile)) + labs(title="The Longest Lasting Songs were Acoustic")
filt$weeks_quartile<-quantcut(normalized, 5)
temp<-full %>%filter(date >= '2011-01-01' & date <= '2015-12-31', `weeks-on-board` >29)
temp$acousticness %>% sd()
filt %>%
ggplot() + geom_boxplot(aes(weeks_quartile, acousticness, group = weeks_quartile)) + labs(title="The Longest Lasting Songs were Acoustic")
filt$weeks_quartile<-quantcut(normalized, 10)
temp<-full %>%filter(date >= '2011-01-01' & date <= '2015-12-31', `weeks-on-board` >29)
temp$acousticness %>% sd()
filt %>%
ggplot() + geom_boxplot(aes(weeks_quartile, acousticness, group = weeks_quartile)) + labs(title="The Longest Lasting Songs were Acoustic")
filt$weeks_quartile<-quantcut(normalized, 5)
temp<-full %>%filter(date >= '2011-01-01' & date <= '2015-12-31', `weeks-on-board` >29)
temp$acousticness %>% sd()
filt %>%
ggplot() + geom_boxplot(aes(weeks_quartile, acousticness, group = weeks_quartile)) + labs(title="The Longest Lasting Songs were Acoustic")
filt$weeks_quartile<-quantcut(normalized, 4)
temp<-full %>%filter(date >= '2011-01-01' & date <= '2015-12-31', `weeks-on-board` >29)
temp$acousticness %>% sd()
filt %>%
ggplot() + geom_boxplot(aes(weeks_quartile, acousticness, group = weeks_quartile)) + labs(title="The Longest Lasting Songs were Acoustic")
filt %>%
ggplot() + geom_violin(aes(weeks_quartile, acousticness, group = weeks_quartile)) + labs(title="The Longest Lasting Songs were Acoustic")
filt %>%
ggplot() + geom_boxplot(aes(weeks_quartile, acousticness, group = weeks_quartile)) + labs(title="The Longest Lasting Songs were Acoustic")
#Plot Two
(plt_4 |plt_5)
##2016-2021
filt2<- full %>%  filter(date >= '2016-01-01')
x2<-filt2$`weeks-on-board`
filt2$normalized2 = (x2-min(x2))/(max(x2)-min(x2))
filt2$weeks_quartile<-quantcut(normalized2, 4)
filt2 %>%
ggplot() + geom_boxplot(aes(weeks_quartile, acousticness, group = weeks_quartile)) + labs(title="..But not so for these years")
##2016-2021
filt2<- full %>%  filter(date >= '2016-01-01')
x<-filt2$`weeks-on-board`
x
##Investigating the Acoustic Songs in 2010-2015
full %>%  filter(date >= '2011-01-01' & date <= '2015-12-31') %>% select(`weeks-on-board`)
filt<- full %>%  filter(date >= '2011-01-01' & date <= '2015-12-31')
x<-filt$`weeks-on-board`
filt$normalized = (x-min(x))/(max(x)-min(x))
filt$weeks_quartile<-quantcut(normalized, 4)
temp<-full %>%filter(date >= '2011-01-01' & date <= '2015-12-31', `weeks-on-board` >29)
temp$acousticness %>% sd()
filt %>%
ggplot() + geom_boxplot(aes(weeks_quartile, acousticness, group = weeks_quartile)) + labs(title="The Longest Lasting Songs were Acoustic")
##2016-2021
filt2<- full %>%  filter(date >= '2016-01-01')
x2<-filt2$`weeks-on-board`
filt2$weeks_quartile<-quantcut(normalized, 4)
filt2 %>% ggplot() + geom_boxplot(aes(weeks_quartile, acousticness, group = weeks_quartile))
##2016-2021
filt2<- full %>%  filter(date >= '2016-01-01')
filt2
x2<-filt2$`weeks-on-board`
filt2$normalized = (x2-min(x2))/(max(x2)-min(x2))
filt2$weeks_quartile<-quantcut(normalized, 4)
##Investigating the Acoustic Songs in 2010-2015
full %>%  filter(date >= '2011-01-01' & date <= '2015-12-31') %>% select(`weeks-on-board`)
filt<- full %>%  filter(date >= '2011-01-01' & date <= '2015-12-31')
x<-filt$`weeks-on-board`
filt$normalized = (x-min(x))/(max(x)-min(x))
filt$weeks_quartile<-quantcut(normalized, 4)
temp<-full %>%filter(date >= '2011-01-01' & date <= '2015-12-31', `weeks-on-board` >29)
temp$acousticness %>% sd()
filt %>%
ggplot() + geom_boxplot(aes(weeks_quartile, acousticness, group = weeks_quartile)) + labs(title="The Longest Lasting Songs were Acoustic")
normalized
##Investigating the Acoustic Songs in 2010-2015
full %>%  filter(date >= '2011-01-01' & date <= '2015-12-31') %>% select(`weeks-on-board`)
filt<- full %>%  filter(date >= '2011-01-01' & date <= '2015-12-31')
x<-filt$`weeks-on-board`
normalized = (x-min(x))/(max(x)-min(x))
filt$weeks_quartile<-quantcut(normalized, 4)
temp<-full %>%filter(date >= '2011-01-01' & date <= '2015-12-31', `weeks-on-board` >29)
temp$acousticness %>% sd()
filt %>%
ggplot() + geom_boxplot(aes(weeks_quartile, acousticness, group = weeks_quartile)) + labs(title="The Longest Lasting Songs were Acoustic")
##2016-2021
filt2<- full %>%  filter(date >= '2016-01-01')
x2<-filt2$`weeks-on-board`
normalized2 = (x2-min(x2))/(max(x2)-min(x2))
filt2$weeks_quartile<-quantcut(normalized2, 4)
filt2 %>% ggplot() + geom_boxplot(aes(weeks_quartile, acousticness, group = weeks_quartile))
##Investigating the Acoustic Songs in 2010-2015
full %>%  filter(date >= '2011-01-01' & date <= '2015-12-31') %>% select(`weeks-on-board`)
filt<- full %>%  filter(date >= '2011-01-01' & date <= '2015-12-31')
x<-filt$`weeks-on-board`
normalized = (x-min(x))/(max(x)-min(x))
filt$weeks_quartile<-quantcut(normalized, 4)
temp<-full %>%filter(date >= '2011-01-01' & date <= '2015-12-31', `weeks-on-board` >29)
temp$acousticness %>% sd()
filt %>%
ggplot() + geom_boxplot(aes(weeks_quartile, acousticness, group = weeks_quartile)) + labs(title="The Longest Lasting Songs were Acoustic...")
##2016-2021
filt2<- full %>%  filter(date >= '2016-01-01')
x2<-filt2$`weeks-on-board`
normalized2 = (x2-min(x2))/(max(x2)-min(x2))
filt2$weeks_quartile<-quantcut(normalized2, 4)
filt2 %>% ggplot() + geom_boxplot(aes(weeks_quartile, acousticness, group = weeks_quartile)) labs(title="...but not anymore!")
filt2 %>% ggplot() + geom_boxplot(aes(weeks_quartile, acousticness, group = weeks_quartile))  + labs(title="...but not anymore!")
filt2 %>% ggplot() + geom_boxplot(aes(weeks_quartile, acousticness, group = weeks_quartile), color = blue)  + labs(title="...but not anymore!")
filt2 %>% ggplot() + geom_boxplot(aes(weeks_quartile, acousticness, group = weeks_quartile, color = blue))  + labs(title="...but not anymore!")
filt2 %>% ggplot() + geom_boxplot(aes(weeks_quartile, acousticness, group = weeks_quartile))  + labs(title="...but not anymore!")
p1+p2
p1<- filt %>%
ggplot() + geom_boxplot(aes(weeks_quartile, acousticness, group = weeks_quartile)) + labs(title="The Longest Lasting Songs were Acoustic...")
##2016-2021
filt2<- full %>%  filter(date >= '2016-01-01')
x2<-filt2$`weeks-on-board`
normalized2 = (x2-min(x2))/(max(x2)-min(x2))
filt2$weeks_quartile<-quantcut(normalized2, 4)
p2<- filt2 %>% ggplot() + geom_boxplot(aes(weeks_quartile, acousticness, group = weeks_quartile))  + labs(title="...but not anymore!")
p1+p2
library(tidyverse)
library(plyr)
library(stringr)
library(RColorBrewer)
library(writexl)
library(data.table)
library(readxl)
library(ggcorrplot)
library(patchwork)
library(gtools)
charts <- read_csv('charts.csv')
songs <- read_csv('song_data.csv')
coul <- colorRampPalette(brewer.pal(8, "PRGn"))(25)
#regularize name column
songs<-songs%>%dplyr::rename(song = song_name)
##Approach
nuchart <- charts %>% filter(date >= '1997-08-31', rank<=5, `peak-rank`<=3) %>% distinct(song, artist, .keep_all = T) %>% left_join(songs, by = "song") %>% distinct(song, artist , .keep_all =T) %>%
select(date, rank, song, artist, `peak-rank`, `weeks-on-board`, acousticness,danceability,energy,instrumentalness,liveness,loudness, tempo, speechiness) %>%
as.data.frame() %>% write_xlsx('/home/srikar/Code/R_Project/top.xlsx')
#1997 onwards
full<-read_excel('topfill.xlsx')
full %>% select(`peak-rank`, `weeks-on-board`, acousticness,danceability,energy,instrumentalness,liveness,loudness, tempo, speechiness, happiness) %>%
as.matrix() %>% cor(use="complete.obs") %>% heatmap(col = coul)
full %>% select(`peak-rank`, `weeks-on-board`, acousticness,danceability,energy,instrumentalness,liveness,loudness, tempo, speechiness, happiness) %>%
as.matrix() %>% cor(use="complete.obs")
#1997 to 2000
#pmatrix
p.mat90 <- full %>%  filter(date < '2000-01-01') %>% select(`peak-rank`, `weeks-on-board`, acousticness,danceability,energy,instrumentalness,liveness,loudness, tempo, speechiness, happiness) %>%
as.matrix() %>% cor(use="complete.obs") %>% cor_pmat()
#corr matrix and plot
plt_1<- full %>%  filter(date < '2000-01-01') %>% select(`peak-rank`, `weeks-on-board`, acousticness,danceability,energy,instrumentalness,liveness,loudness, tempo, speechiness, happiness) %>%
as.matrix() %>% cor(use="complete.obs") %>%
ggcorrplot(type = "lower", lab = TRUE, insig = "blank", p.mat = p.mat90) +labs(title="1997-2000 Correlations")
#2000 to 2005
#pmatrix
p.mat00 <- full %>%  filter(date >= '2000-01-01' & date<="2005-12-31") %>% select(`peak-rank`, `weeks-on-board`, acousticness,danceability,energy,instrumentalness,liveness,loudness, tempo, speechiness, happiness) %>%
as.matrix() %>% cor(use="complete.obs") %>% cor_pmat()
#corr matrix and plot
plt_2<-full %>%  filter(date >= '2000-01-01' & date<="2005-12-31") %>% select(`peak-rank`, `weeks-on-board`, acousticness,danceability,energy,instrumentalness,liveness,loudness, tempo, speechiness, happiness) %>%
as.matrix() %>% cor(use="complete.obs") %>%
ggcorrplot(type = "lower", lab = TRUE, insig = "blank", p.mat = p.mat00) +labs(title="2001-2005 Correlations")
#2005 to 2010
#pmatrix
p.mat05 <- full %>%  filter(date >= '2006-01-01' & date <= "2010-12-31") %>% select(`peak-rank`, `weeks-on-board`, acousticness,danceability,energy,instrumentalness,liveness,loudness, tempo, speechiness, happiness) %>%
as.matrix() %>% cor(use="complete.obs") %>% cor_pmat()
#corr matrix and plot
plt_3<-full %>%  filter(date >= '2006-01-01' & date <= "2010-12-31") %>% select(`peak-rank`, `weeks-on-board`, acousticness,danceability,energy,instrumentalness,liveness,loudness, tempo, speechiness, happiness) %>%
as.matrix() %>% cor(use="complete.obs") %>%
ggcorrplot(type = "lower", lab = TRUE, insig = "blank", p.mat = p.mat05) +labs(title="2006-2010 Correlations")
#2010 to 2015
#pmatrix
p.mat10<- full %>%  filter(date >= '2011-01-01' & date <= '2015-12-31') %>% select(`peak-rank`, `weeks-on-board`, acousticness,danceability,energy,instrumentalness,liveness,loudness, tempo, speechiness, happiness) %>%
as.matrix() %>% cor(use="complete.obs") %>% cor_pmat()
#corr matrix and plot
plt_4<-full %>%  filter(date >= '2011-01-01' & date <= '2015-12-31') %>% select(`peak-rank`, `weeks-on-board`, acousticness,danceability,energy,instrumentalness,liveness,loudness, tempo, speechiness, happiness) %>%
as.matrix() %>% cor(use="complete.obs") %>%
ggcorrplot( type = "lower", lab = TRUE, insig = "blank", p.mat = p.mat10) +labs(title="2011-2015 Correlations")
#2015 to 2021
#pmatrix
p.mat15<- full %>% filter(date >= '2016-01-01') %>% select(`peak-rank`, `weeks-on-board`, acousticness,danceability,energy,instrumentalness,liveness,loudness, tempo, speechiness, happiness) %>%
as.matrix() %>% cor(use="complete.obs") %>% cor_pmat()
#corr matrix and plot
plt_5<-full %>% filter(date >= '2016-01-01') %>% select(`peak-rank`, `weeks-on-board`, acousticness,danceability,energy,instrumentalness,liveness,loudness, tempo, speechiness, happiness) %>%
as.matrix() %>% cor(use="complete.obs") %>%
ggcorrplot( type = "lower", lab = TRUE, insig = "blank", p.mat = p.mat15) +labs(title="2016-2021 Correlations")
#Plot One
(plt_1 + plt_2+ plt_3)
#Plot Two
(plt_4 |plt_5)
install.packages("shiny")
library(shiny)
runExample("01_hello")
runApp("shiny")
runApp('shiny')
runApp('shiny')
runApp('shiny')
runApp('shiny')
runApp('shiny')
runApp('shiny')
runApp('shiny')
runApp('shiny')
runApp('shiny')
runApp('shiny')
runApp('shiny')
runApp('shiny')
runApp('shiny')
runApp('shiny')
runApp('shiny')
full<-read_excel('topfill.xlsx')
#pmatrix
p <- full %>%  filter(date >= input$dates[1] & date<=input$dates[2]) %>% select(`peak-rank`, `weeks-on-board`, acousticness,danceability,energy,instrumentalness,liveness,loudness, tempo, speechiness, happiness) %>%
as.matrix() %>% cor(use="complete.obs") %>% cor_pmat()
#corr matrix and plot
plt <-full %>%  filter(date >= input$dates[1] & date<=input$dates[2]) %>% select(`peak-rank`, `weeks-on-board`, acousticness,danceability,energy,instrumentalness,liveness,loudness, tempo, speechiness, happiness) %>%
as.matrix() %>% cor(use="complete.obs") %>%
ggcorrplot(type = "lower", lab = TRUE, insig = "blank", p.mat = p.mat00)
plt
full<-read_excel('topfill.xlsx')
#pmatrix
p <- full %>%  filter(date >= input$dates[1] & date<=input$dates[2]) %>% select(`peak-rank`, `weeks-on-board`, acousticness,danceability,energy,instrumentalness,liveness,loudness, tempo, speechiness, happiness) %>%
as.matrix() %>% cor(use="complete.obs") %>% cor_pmat()
#corr matrix and plot
plt <-full %>%  filter(date >= input$dates[1] & date<=input$dates[2]) %>% select(`peak-rank`, `weeks-on-board`, acousticness,danceability,energy,instrumentalness,liveness,loudness, tempo, speechiness, happiness) %>%
as.matrix() %>% cor(use="complete.obs") %>%
ggcorrplot(type = "lower", lab = TRUE, insig = "blank", p.mat = p.mat00)
plt
runApp('shiny')
getwd()
runApp('shiny')
runApp('shiny')
install.packages("shinythemes")
runApp('shiny')
runApp('shiny')
runApp('shiny')
runApp('shiny')
runApp('shiny')
runApp('shiny')
runApp('shiny')
runApp('shiny')
runApp('shiny')
runApp('shiny')
install.packages('rsconnect')
rsconnect::setAccountInfo(name='sacredfisher',
token='111EF2464C36ECABFD35AE5E5B663C98',
secret='<SECRET>')
rsconnect::setAccountInfo(name='sacredfisher', token='111EF2464C36ECABFD35AE5E5B663C98', secret='7/UVGpJ634tA4mtjjO2As4Xfdr4+Ix+kh/+Xsj+8')
library(rsconnect)
rsconnect::deployApp('/home/srikar/Code/R_Project/shiny/')
runApp('shiny')
library(rsconnect)
rsconnect::deployApp('/home/srikar/Code/R_Project/shiny/')
runApp('shiny')
library(rsconnect)
rsconnect::deployApp('/home/srikar/Code/R_Project/shiny/')
library(tidyverse)
library(plyr)
library(stringr)
library(RColorBrewer)
library(writexl)
library(data.table)
library(readxl)
library(ggcorrplot)
library(patchwork)
library(gtools)
charts <- read_csv('charts.csv')
songs <- read_csv('song_data.csv')
#regularize name column
songs<-songs%>%dplyr::rename(song = song_name)
##Approach
nuchart <- charts %>% filter(date >= '1997-08-31', rank<=5, `peak-rank`<=3) %>% distinct(song, artist, .keep_all = T) %>% left_join(songs, by = "song") %>% distinct(song, artist , .keep_all =T) %>%
select(date, rank, song, artist, `peak-rank`, `weeks-on-board`, acousticness,danceability,energy,instrumentalness,liveness,loudness, tempo, speechiness) %>%
as.data.frame() %>% write_xlsx('/home/srikar/Code/R_Project/top.xlsx')
#1997 onwards
full<-read_excel('topfill.xlsx')
full %>% select(`peak-rank`, `weeks-on-board`, acousticness,danceability,energy,instrumentalness,liveness,loudness, tempo, speechiness, happiness) %>%
as.matrix() %>% cor(use="complete.obs")
#1997 to 2000
#pmatrix
p.mat90 <- full %>%  filter(date < '2000-01-01') %>% select(`peak-rank`, `weeks-on-board`, acousticness,danceability,energy,instrumentalness,liveness,loudness, tempo, speechiness, happiness) %>%
as.matrix() %>% cor(use="complete.obs") %>% cor_pmat()
#corr matrix and plot
plt_1<- full %>%  filter(date < '2000-01-01') %>% select(`peak-rank`, `weeks-on-board`, acousticness,danceability,energy,instrumentalness,liveness,loudness, tempo, speechiness, happiness) %>%
as.matrix() %>% cor(use="complete.obs") %>%
ggcorrplot(type = "lower", lab = TRUE, insig = "blank", p.mat = p.mat90) +labs(title="1997-2000 Correlations")
#2000 to 2005
#pmatrix
p.mat00 <- full %>%  filter(date >= '2000-01-01' & date<="2005-12-31") %>% select(`peak-rank`, `weeks-on-board`, acousticness,danceability,energy,instrumentalness,liveness,loudness, tempo, speechiness, happiness) %>%
as.matrix() %>% cor(use="complete.obs") %>% cor_pmat()
#corr matrix and plot
plt_2<-full %>%  filter(date >= '2000-01-01' & date<="2005-12-31") %>% select(`peak-rank`, `weeks-on-board`, acousticness,danceability,energy,instrumentalness,liveness,loudness, tempo, speechiness, happiness) %>%
as.matrix() %>% cor(use="complete.obs") %>%
ggcorrplot(type = "lower", lab = TRUE, insig = "blank", p.mat = p.mat00) +labs(title="2001-2005 Correlations")
#2005 to 2010
#pmatrix
p.mat05 <- full %>%  filter(date >= '2006-01-01' & date <= "2010-12-31") %>% select(`peak-rank`, `weeks-on-board`, acousticness,danceability,energy,instrumentalness,liveness,loudness, tempo, speechiness, happiness) %>%
as.matrix() %>% cor(use="complete.obs") %>% cor_pmat()
#corr matrix and plot
plt_3<-full %>%  filter(date >= '2006-01-01' & date <= "2010-12-31") %>% select(`peak-rank`, `weeks-on-board`, acousticness,danceability,energy,instrumentalness,liveness,loudness, tempo, speechiness, happiness) %>%
as.matrix() %>% cor(use="complete.obs") %>%
ggcorrplot(type = "lower", lab = TRUE, insig = "blank", p.mat = p.mat05) +labs(title="2006-2010 Correlations")
#2010 to 2015
#pmatrix
p.mat10<- full %>%  filter(date >= '2011-01-01' & date <= '2015-12-31') %>% select(`peak-rank`, `weeks-on-board`, acousticness,danceability,energy,instrumentalness,liveness,loudness, tempo, speechiness, happiness) %>%
as.matrix() %>% cor(use="complete.obs") %>% cor_pmat()
#corr matrix and plot
plt_4<-full %>%  filter(date >= '2011-01-01' & date <= '2015-12-31') %>% select(`peak-rank`, `weeks-on-board`, acousticness,danceability,energy,instrumentalness,liveness,loudness, tempo, speechiness, happiness) %>%
as.matrix() %>% cor(use="complete.obs") %>%
ggcorrplot( type = "lower", lab = TRUE, insig = "blank", p.mat = p.mat10) +labs(title="2011-2015 Correlations")
#2015 to 2021
#pmatrix
p.mat15<- full %>% filter(date >= '2016-01-01') %>% select(`peak-rank`, `weeks-on-board`, acousticness,danceability,energy,instrumentalness,liveness,loudness, tempo, speechiness, happiness) %>%
as.matrix() %>% cor(use="complete.obs") %>% cor_pmat()
#corr matrix and plot
plt_5<-full %>% filter(date >= '2016-01-01') %>% select(`peak-rank`, `weeks-on-board`, acousticness,danceability,energy,instrumentalness,liveness,loudness, tempo, speechiness, happiness) %>%
as.matrix() %>% cor(use="complete.obs") %>%
ggcorrplot( type = "lower", lab = TRUE, insig = "blank", p.mat = p.mat15) +labs(title="2016-2021 Correlations")
#Plot One
(plt_1 + plt_2+ plt_3)
#Plot Two
(plt_4 |plt_5)
##Investigating the Acoustic Songs in 2010-2015
full %>%  filter(date >= '2011-01-01' & date <= '2015-12-31') %>% select(`weeks-on-board`)
filt<- full %>%  filter(date >= '2011-01-01' & date <= '2015-12-31')
x<-filt$`weeks-on-board`
normalized = (x-min(x))/(max(x)-min(x))
filt$weeks_quartile<-quantcut(normalized, 4)
temp<-full %>%filter(date >= '2011-01-01' & date <= '2015-12-31', `weeks-on-board` >29)
temp$acousticness %>% sd()
p1<- filt %>%
ggplot() + geom_boxplot(aes(weeks_quartile, acousticness, group = weeks_quartile)) + labs(title="The Longest Lasting Songs were Acoustic...")
##2016-2021
filt2<- full %>%  filter(date >= '2016-01-01')
x2<-filt2$`weeks-on-board`
normalized2 = (x2-min(x2))/(max(x2)-min(x2))
filt2$weeks_quartile<-quantcut(normalized2, 4)
p2<- filt2 %>% ggplot() + geom_boxplot(aes(weeks_quartile, acousticness, group = weeks_quartile))  + labs(title="...but not anymore!")
p1+p2
p.mat15
full %>% select(`peak-rank`, `weeks-on-board`, acousticness,danceability,energy,instrumentalness,liveness,loudness, tempo, speechiness, happiness) %>%
as.matrix() %>% cor(use="complete.obs") %>% ggcorrplot(type = "lower")
full %>% select(`peak-rank`, `weeks-on-board`, acousticness,danceability,energy,instrumentalness,liveness,loudness, tempo, speechiness, happiness) %>%
as.matrix() %>% cor(use="complete.obs") %>% ggcorrplot(type = "lower") +labs(title="1997-2021 Correlations")
#1997 onwards
full<-read_excel('topfill.xlsx')
p.matall <-full %>% select(`peak-rank`, `weeks-on-board`, acousticness,danceability,energy,instrumentalness,liveness,loudness, tempo, speechiness, happiness) %>%
as.matrix() %>% cor(use="complete.obs") %>% cor_pmat()
full %>% select(`peak-rank`, `weeks-on-board`, acousticness,danceability,energy,instrumentalness,liveness,loudness, tempo, speechiness, happiness) %>%
as.matrix() %>% cor(use="complete.obs") %>% ggcorrplot(type = "lower", lab = TRUE, insig = "blank", p.mat = p.matall) +labs(title="1997-2021 Correlations")
